<!DOCTYPE html>
<html>
<head>
<title>Admin Panel - Y N Hosakote</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyANO19SvpXnBRbVssgO5My_RZUGIdbV_eU",
  authDomain: "ynhosakote-portal.firebaseapp.com",
  projectId: "ynhosakote-portal",
  storageBucket: "ynhosakote-portal.firebasestorage.app",
  messagingSenderId: "590401150310",
  appId: "1:590401150310:web:1af5701c6dae674c0b7ca7",
  measurementId: "G-ZGML7T4PET"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

window.publishAnnouncement = async function(){
  const title = document.getElementById("title").value;
  const message = document.getElementById("message").value;

  await addDoc(collection(db, "announcements"), {
    title: title,
    message: message,
    date: new Date().toLocaleDateString()
  });

  alert("Announcement Published!");
}

</script>

  
body{
font-family:Segoe UI;
background:#f1f5f9;
display:flex;
justify-content:center;
align-items:center;
height:100vh;
margin:0;
}

.panel{
background:white;
padding:30px;
border-radius:12px;
width:380px;
box-shadow:0 10px 30px rgba(0,0,0,.15);
text-align:center;
}

textarea{
width:100%;
height:120px;
margin-top:15px;
padding:10px;
border-radius:8px;
border:1px solid #ccc;
}

button{
margin-top:15px;
padding:12px;
width:100%;
border:none;
border-radius:8px;
background:#22c55e;
color:white;
font-weight:bold;
cursor:pointer;
}

.delete{
background:#ef4444;
}

#postArea{display:none;}
</style>
</head>

<body>

<div class="panel">

<h2>Village Admin Login</h2>

<button onclick="login()">Login with Google</button>

<div id="postArea">
<h3>Post Announcement</h3>
<textarea id="notice"></textarea>
<button onclick="postNotice()">Publish</button>

<h3>Delete Latest Notice</h3>
<button class="delete" onclick="deleteNotice()">Delete Last</button>

<p id="status"></p>
</div>

</div>

<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>

<script>
const firebaseConfig = {
apiKey:"demo",
authDomain:"demo.firebaseapp.com",
projectId:"demo"
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

function login(){
const provider=new firebase.auth.GoogleAuthProvider();
auth.signInWithPopup(provider).then(()=>{
document.getElementById("postArea").style.display="block";
});
}

function postNotice(){
let text=document.getElementById("notice").value;

db.collection("announcements").add({
message:text,
time:Date.now()
}).then(()=>{
document.getElementById("status").innerHTML="Notice Posted!";
});
}

function deleteNotice(){
db.collection("announcements")
.orderBy("time","desc")
.limit(1)
.get()
.then(s=>{
s.forEach(doc=>db.collection("announcements").doc(doc.id).delete());
document.getElementById("status").innerHTML="Deleted";
});
}
</script>

</body>
</html>
